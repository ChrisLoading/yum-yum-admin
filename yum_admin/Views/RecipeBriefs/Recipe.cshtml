@model IEnumerable<yum_admin.Models.ViewModels.RecipeViewModel>


@{
    ViewBag.Title = "Recipe List";
    var latestRecipes = Model
        .GroupBy(r => r.RecipeId)
        .Select(g => g.OrderByDescending(r => r.RecipeRecDate).FirstOrDefault());
}



<div class="container">

    <!-- 表頭 -->
    <ul class="responsive-table">
        <li class="table-header">
            <div class="col col-1">狀態</div>
            <div class="col col-2">食譜名稱</div>
            <div class="col col-3">作者</div>
            <div class="col col-4">步驟</div>
            <div class="col col-5">異動日期</div>
            <div class="col col-6">變更</div>
        </li>


        @foreach (var item in latestRecipes)
        {

            <!-- 每一筆資料行  -->
            <li class="table-row">

                <!-- 判斷狀態顯示 -->
                @{
                    string idName = "";
                    string cssClass = "";
                    string Text = "";
                    int stateCode = item?.RecipeStateCode ?? 0; // 預設值為 0（草稿）

                    switch (stateCode)
                    {
                        case 1:
                            idName = "StatusNew";
                            cssClass = "btn-primary";
                            Text = "新上架";
                            break;
                        case 2:
                            idName = "StatusReturn";
                            cssClass = "btn-danger";
                            Text = "退回請改";
                            break;
                        case 3:
                            idName = "StatusPending";
                            cssClass = "btn-warning";
                            Text = "待審查";
                            break;
                        case 4:
                            idName = "StatusApproved";
                            cssClass = "btn-success";
                            Text = "已確認";
                            break;
                        case 5:
                            idName = "StatusDefault";
                            cssClass = "btn-secondary";
                            Text = "已隱藏";
                            break;
                        case 0:
                            idName = "StatusDefault";
                            cssClass = "btn-secondary";
                            Text = "草稿";
                            break;
                        default:
                            idName = "StatusNew";
                            cssClass = "btn-secondary"; 
                            Text = "未知狀態";
                            break;
                    }
                }

                <div class="col col-1" data-label="RecipeStateDescript" id="@idName">
                    <div class="status-label @cssClass rounded-5 align-content-center fw-400">
                        <span>@Text</span>
                    </div>
                </div>

                <div class="col col-2" data-label="RecipeName">@item!.RecipeName</div>
                <div class="col col-3" data-label="UserName">@item!.UserNickname</div>
                <div class="col col-4" data-label="RecipeSteps">@item!.RecipeField</div>
                <div class="col col-5" data-label="ModificationDate">@item!.RecipeRecDate.ToString("yyyy-MM-dd")</div>
                <div class="col col-6" data-label="ModificationBtn">

                    @* 食譜詳情按鈕 *@
                    <button id="@item.RecipeField" class="btn text-center justify-content-center lh-5 btn-hover " onclick="window.location.href='@Url.Action("RecipeDetail", "RecipeBriefs", new { recipeId = item.RecipeId })';">
                        <svg class="" height="20px" viewBox="0 -960 960 960" width="20px" fill="none">
                            <path d="M216-216h51l375-375-51-51-375 375v51Zm-72 72v-153l498-498q11-11 23.84-16 12.83-5 27-5 14.16 0 27.16 5t24 16l51 51q11 11 16 24t5 26.54q0 14.45-5.02 27.54T795-642L297-144H144Zm600-549-51-51 51 51Zm-127.95 76.95L591-642l51 51-25.95-25.05Z"
                                  fill="#0d6efd" />
                        </svg>
                    </button>
                    @* 食譜刪除按鈕 --還沒設定*@
                    <button id="btn-delete"
                            class="btn text-center justify-content-center lh-5 btn-hover btn-delete" onclick="window.location.href='@Url.Action("RecipeDetail", "RecipeBriefs", new { recipeId = item.RecipeId })';">
                        <svg class="" height="20px" viewBox="0 -960 960 960" width="20px" fill="none">
                            <path d="M312-144q-29.7 0-50.85-21.15Q240-186.3 240-216v-480h-48v-72h192v-48h192v48h192v72h-48v479.57Q720-186 698.85-165T648-144H312Zm336-552H312v480h336v-480ZM384-288h72v-336h-72v336Zm120 0h72v-336h-72v336ZM312-696v480-480Z" />
                        </svg>
                    </button>

                </div>
            </li>
        }
    </ul>
</div>